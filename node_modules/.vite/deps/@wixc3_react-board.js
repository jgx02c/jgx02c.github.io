import {
  require_client,
  require_react_dom
} from "./chunk-BUJM365A.js";
import {
  require_react
} from "./chunk-BZN7XFWI.js";
import {
  __commonJS
} from "./chunk-76J2PTFD.js";

// node_modules/@wixc3/board-core/dist/create-metadata.js
var require_create_metadata = __commonJS({
  "node_modules/@wixc3/board-core/dist/create-metadata.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.createMetadata = void 0;
    function createMetadata(metadata) {
      return metadata;
    }
    exports.createMetadata = createMetadata;
  }
});

// node_modules/@wixc3/board-core/dist/hooks.js
var require_hooks = __commonJS({
  "node_modules/@wixc3/board-core/dist/hooks.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.callHooks = exports.getPluginsWithHooks = void 0;
    function getPluginsWithHooks(data, hookName) {
      if (!data.plugins) {
        return [];
      }
      return data.plugins.filter((item) => !!item.key.plugin[hookName]);
    }
    exports.getPluginsWithHooks = getPluginsWithHooks;
    function callHooks(data, hookName, ...props) {
      const plugins = getPluginsWithHooks(data, hookName);
      for (const pluginInfo of plugins) {
        if (pluginInfo.key.plugin[hookName]) {
          pluginInfo.key.plugin[hookName](pluginInfo.props, ...props);
        }
      }
    }
    exports.callHooks = callHooks;
  }
});

// node_modules/@wixc3/board-core/dist/setup-stage.js
var require_setup_stage = __commonJS({
  "node_modules/@wixc3/board-core/dist/setup-stage.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.setupBoardStage = exports.defaultEnvironmentProperties = exports.defaultCanvasStyles = exports.defaultWindowStyles = void 0;
    var hooks_1 = require_hooks();
    exports.defaultWindowStyles = {
      width: 1024,
      height: 640
    };
    exports.defaultCanvasStyles = {
      width: "fit-content",
      height: "fit-content",
      marginLeft: "auto",
      marginRight: "auto",
      marginBottom: "auto",
      marginTop: "auto",
      paddingLeft: "0px",
      paddingRight: "0px",
      paddingBottom: "0px",
      paddingTop: "0px"
    };
    exports.defaultEnvironmentProperties = {
      windowWidth: exports.defaultWindowStyles.width,
      windowHeight: exports.defaultWindowStyles.height,
      canvasMargin: {},
      canvasPadding: {}
    };
    var applyStylesToWindow = (windowStyles = {}, previousProps) => {
      previousProps.windowHeight = previousProps.windowHeight ? window.outerHeight : exports.defaultWindowStyles.height;
      previousProps.windowWidth = previousProps.windowWidth ? window.outerWidth : exports.defaultWindowStyles.width;
      window.resizeTo(windowStyles.windowWidth || previousProps.windowWidth, windowStyles.windowHeight || previousProps.windowHeight);
      document.body.style.backgroundColor = windowStyles.windowBackgroundColor || "";
    };
    var applyStylesToCanvas = (canvas, environmentProps = {}) => {
      var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;
      const canvasStyle = {
        width: environmentProps.canvasWidth ? `${environmentProps.canvasWidth}px` : exports.defaultCanvasStyles.width,
        height: environmentProps.canvasHeight ? `${environmentProps.canvasHeight}px` : exports.defaultCanvasStyles.height,
        marginLeft: ((_a = environmentProps.canvasMargin) === null || _a === void 0 ? void 0 : _a.left) ? `${(_b = environmentProps.canvasMargin) === null || _b === void 0 ? void 0 : _b.left}px` : exports.defaultCanvasStyles.marginLeft,
        marginRight: ((_c = environmentProps.canvasMargin) === null || _c === void 0 ? void 0 : _c.right) ? `${(_d = environmentProps.canvasMargin) === null || _d === void 0 ? void 0 : _d.right}px` : exports.defaultCanvasStyles.marginRight,
        marginBottom: ((_e = environmentProps.canvasMargin) === null || _e === void 0 ? void 0 : _e.bottom) ? `${(_f = environmentProps.canvasMargin) === null || _f === void 0 ? void 0 : _f.bottom}px` : exports.defaultCanvasStyles.marginBottom,
        marginTop: ((_g = environmentProps.canvasMargin) === null || _g === void 0 ? void 0 : _g.top) ? `${(_h = environmentProps.canvasMargin) === null || _h === void 0 ? void 0 : _h.top}px` : exports.defaultCanvasStyles.marginTop,
        paddingLeft: ((_j = environmentProps.canvasPadding) === null || _j === void 0 ? void 0 : _j.left) ? `${(_k = environmentProps.canvasPadding) === null || _k === void 0 ? void 0 : _k.left}px` : exports.defaultCanvasStyles.paddingLeft,
        paddingRight: ((_l = environmentProps.canvasPadding) === null || _l === void 0 ? void 0 : _l.right) ? `${(_m = environmentProps.canvasPadding) === null || _m === void 0 ? void 0 : _m.right}px` : exports.defaultCanvasStyles.paddingRight,
        paddingBottom: ((_o = environmentProps.canvasPadding) === null || _o === void 0 ? void 0 : _o.bottom) ? `${(_p = environmentProps.canvasPadding) === null || _p === void 0 ? void 0 : _p.bottom}px` : exports.defaultCanvasStyles.paddingBottom,
        paddingTop: ((_q = environmentProps.canvasPadding) === null || _q === void 0 ? void 0 : _q.top) ? `${(_r = environmentProps.canvasPadding) === null || _r === void 0 ? void 0 : _r.top}px` : exports.defaultCanvasStyles.paddingTop,
        backgroundColor: environmentProps.canvasBackgroundColor || ""
      };
      if (((_s = environmentProps.canvasMargin) === null || _s === void 0 ? void 0 : _s.left) !== void 0 && environmentProps.canvasMargin.right !== void 0) {
        canvasStyle.width = "100%";
      }
      if (((_t = environmentProps.canvasMargin) === null || _t === void 0 ? void 0 : _t.top) !== void 0 && environmentProps.canvasMargin.bottom !== void 0) {
        canvasStyle.height = "auto";
      }
      Object.assign(canvas.style, canvasStyle);
    };
    var setupBoardStage = (board, parentElement) => {
      const previousWindowEnvironmentProps = {};
      const canvas = document.createElement("div");
      canvas.setAttribute("id", "board-canvas");
      const { environmentProps } = board;
      applyStylesToWindow(environmentProps, previousWindowEnvironmentProps);
      applyStylesToCanvas(canvas, environmentProps);
      (0, hooks_1.callHooks)(board, "beforeAppendCanvas", canvas);
      parentElement.appendChild(canvas);
      const updateCanvas = (canvasEnvironmentProps) => {
        applyStylesToCanvas(canvas, canvasEnvironmentProps);
      };
      const updateWindow = (windowEnvironmentProps) => {
        applyStylesToWindow(windowEnvironmentProps, previousWindowEnvironmentProps);
      };
      const cleanup = () => {
        (0, hooks_1.callHooks)(board, "beforeStageCleanUp", canvas);
        canvas.remove();
        if (previousWindowEnvironmentProps.windowWidth && previousWindowEnvironmentProps.windowHeight) {
          window.resizeTo(previousWindowEnvironmentProps.windowWidth, previousWindowEnvironmentProps.windowHeight);
        }
      };
      return { canvas, updateCanvas, updateWindow, cleanup };
    };
    exports.setupBoardStage = setupBoardStage;
  }
});

// node_modules/@wixc3/board-core/dist/create-renderable-base.js
var require_create_renderable_base = __commonJS({
  "node_modules/@wixc3/board-core/dist/create-renderable-base.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.createRenderableBase = exports.baseRender = void 0;
    var create_metadata_1 = require_create_metadata();
    var setup_stage_1 = require_setup_stage();
    var hooks_1 = require_hooks();
    async function baseRender(data, render, canvas) {
      (0, hooks_1.callHooks)(data, "beforeRender", canvas);
      const cleanup = await render(canvas);
      (0, hooks_1.callHooks)(data, "afterRender", canvas);
      return cleanup;
    }
    exports.baseRender = baseRender;
    function createRenderableBase(data) {
      const res = (0, create_metadata_1.createMetadata)(Object.assign(Object.assign({}, data), { setupStage(parentElement = document.body) {
        return (0, setup_stage_1.setupBoardStage)(this, parentElement);
      } }));
      return res;
    }
    exports.createRenderableBase = createRenderableBase;
  }
});

// node_modules/@wixc3/board-core/dist/types.js
var require_types = __commonJS({
  "node_modules/@wixc3/board-core/dist/types.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.createPlugin = exports.defaultMerge = void 0;
    var defaultMerge = (props) => [
      props.reduceRight((acc, curr) => {
        return Object.assign(Object.assign({}, acc), curr);
      })
    ];
    exports.defaultMerge = defaultMerge;
    var createPlugin = () => (pluginName, defaultProps, plugin, merge = exports.defaultMerge) => {
      const res = {
        pluginName,
        defaultProps,
        plugin,
        use: (props) => {
          return {
            key: res,
            props: Object.assign(Object.assign({}, defaultProps), props)
          };
        },
        merge
      };
      return res;
    };
    exports.createPlugin = createPlugin;
  }
});

// node_modules/@wixc3/board-core/dist/index.js
var require_dist = __commonJS({
  "node_modules/@wixc3/board-core/dist/index.js"(exports) {
    "use strict";
    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      var desc = Object.getOwnPropertyDescriptor(m, k);
      if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
        desc = { enumerable: true, get: function() {
          return m[k];
        } };
      }
      Object.defineProperty(o, k2, desc);
    } : function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      o[k2] = m[k];
    });
    var __exportStar = exports && exports.__exportStar || function(m, exports2) {
      for (var p in m)
        if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p))
          __createBinding(exports2, m, p);
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    __exportStar(require_create_metadata(), exports);
    __exportStar(require_create_renderable_base(), exports);
    __exportStar(require_setup_stage(), exports);
    __exportStar(require_hooks(), exports);
    __exportStar(require_types(), exports);
  }
});

// node_modules/@wixc3/react-board/dist/react-error-handled-render.js
var require_react_error_handled_render = __commonJS({
  "node_modules/@wixc3/react-board/dist/react-error-handled-render.js"(exports) {
    "use strict";
    var __importDefault = exports && exports.__importDefault || function(mod) {
      return mod && mod.__esModule ? mod : { "default": mod };
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.reactErrorHandledRendering = void 0;
    var react_1 = __importDefault(require_react());
    var react_dom_1 = __importDefault(require_react_dom());
    var client_1 = __importDefault(require_client());
    var reactRootByContainer = /* @__PURE__ */ new WeakMap();
    var reactErrorHandledRendering = async (element, container) => {
      if (client_1.default.createRoot) {
        const reactRoot = reactRootByContainer.get(container) || client_1.default.createRoot(container);
        reactRootByContainer.set(container, reactRoot);
        const cleanup = () => {
          reactRoot === null || reactRoot === void 0 ? void 0 : reactRoot.unmount();
          reactRootByContainer.delete(container);
        };
        try {
          await new Promise((resolve, reject) => {
            reactRoot === null || reactRoot === void 0 ? void 0 : reactRoot.render(react_1.default.createElement(ErrorBoundary, { onRender: resolve, reportError: reject }, element));
          });
        } catch (e) {
          cleanup();
          throw e;
        }
        return cleanup;
      } else {
        const cleanup = () => react_dom_1.default.unmountComponentAtNode(container);
        try {
          await new Promise((resolve, reject) => {
            react_dom_1.default.render(react_1.default.createElement(ErrorBoundary, { reportError: reject }, element), container, resolve);
          });
        } catch (e) {
          cleanup();
          throw e;
        }
        return cleanup;
      }
    };
    exports.reactErrorHandledRendering = reactErrorHandledRendering;
    var ErrorBoundary = class extends react_1.default.Component {
      constructor() {
        super(...arguments);
        this.state = { hasError: false };
      }
      static getDerivedStateFromError() {
        return { hasError: true };
      }
      componentDidCatch(error, errorInfo) {
        var _a, _b;
        (_b = (_a = this.props).reportError) === null || _b === void 0 ? void 0 : _b.call(_a, error, errorInfo);
      }
      componentDidMount() {
        var _a, _b;
        if (!this.state.hasError) {
          (_b = (_a = this.props).onRender) === null || _b === void 0 ? void 0 : _b.call(_a);
        }
      }
      componentDidUpdate() {
        var _a, _b;
        if (!this.state.hasError) {
          (_b = (_a = this.props).onRender) === null || _b === void 0 ? void 0 : _b.call(_a);
        }
      }
      render() {
        return this.state.hasError ? null : this.props.children;
      }
    };
  }
});

// node_modules/@wixc3/react-board/dist/create-board.js
var require_create_board = __commonJS({
  "node_modules/@wixc3/react-board/dist/create-board.js"(exports) {
    "use strict";
    var __importDefault = exports && exports.__importDefault || function(mod) {
      return mod && mod.__esModule ? mod : { "default": mod };
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.createBoard = void 0;
    var react_1 = __importDefault(require_react());
    var board_core_1 = require_dist();
    var react_error_handled_render_1 = require_react_error_handled_render();
    function createBoard(input) {
      const res = (0, board_core_1.createRenderableBase)(Object.assign(Object.assign({}, input), { render(target) {
        return (0, board_core_1.baseRender)(res, async () => {
          var _a;
          let element = react_1.default.createElement(res.Board, null);
          const wrapRenderPlugins = (0, board_core_1.getPluginsWithHooks)(res, "wrapRender");
          for (const plugin of wrapRenderPlugins) {
            if ((_a = plugin.key.plugin) === null || _a === void 0 ? void 0 : _a.wrapRender) {
              const el = plugin.key.plugin.wrapRender(plugin.props, res, element, target);
              element = el || element;
            }
          }
          return (0, react_error_handled_render_1.reactErrorHandledRendering)(element, target);
        }, target);
      } }));
      return res;
    }
    exports.createBoard = createBoard;
  }
});

// node_modules/@wixc3/react-board/dist/types.js
var require_types2 = __commonJS({
  "node_modules/@wixc3/react-board/dist/types.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
  }
});

// node_modules/@wixc3/react-board/dist/index.js
var require_dist2 = __commonJS({
  "node_modules/@wixc3/react-board/dist/index.js"(exports) {
    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      var desc = Object.getOwnPropertyDescriptor(m, k);
      if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
        desc = { enumerable: true, get: function() {
          return m[k];
        } };
      }
      Object.defineProperty(o, k2, desc);
    } : function(o, m, k, k2) {
      if (k2 === void 0)
        k2 = k;
      o[k2] = m[k];
    });
    var __exportStar = exports && exports.__exportStar || function(m, exports2) {
      for (var p in m)
        if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p))
          __createBinding(exports2, m, p);
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    __exportStar(require_create_board(), exports);
    __exportStar(require_types2(), exports);
  }
});
export default require_dist2();
//# sourceMappingURL=@wixc3_react-board.js.map
